with categories (link,name,contract_like) as (
VALUES ('https://boom.money/nft/mint','Boom NFTs','SP497E7RX3233ATBS2AB9G4WTHB63X5PBSP5VGAQ.boom-nfts')
, ('https://owl.link/','Owl Link','SP3A6FJ92AA0MS2F57DG786TFNG8J785B3F8RSQC9.owl-link')
, ('https://blocksurvey.io/','BlockSurvey','SPNWZ5V2TPWGQGVDR6T7B6RQ4XMGZ4PXTEE0VQ0S.blocksurvey')
, ('https://bitfari.com/','Bitfari','SP213KNHB5QD308TEESY1ZMX1BP8EZDPG4JWD0MEA.%')
, ('https://www.megapont.com/','Megapont','SP3D6PV2ACBPEKYJTCMH7HEN02KP87QSP8KTEH335.%')
, ('https://satoshibles.com/','Satoshibles','SP6P4EJF0VG8V0RB3TQQKJBHDQKEF6NVRD1KZE3C.%')
, ('https://spaghettipunk.com/','Spaghetti Punk','SP1C2K603TGWJGKPT2Z3WWHA0ARM66D352385TTWH.%')
, ('https://stacksdegens.com/','Stacks Degens','SP1SCEXE6PMGPAC6B4N5P2MDKX8V4GF9QDE1FNNGJ.%')
, ('https://punksarmynft.club/','Punks Army','SP2A665S3H6FVMZSY4VJ17ESXX21CGS0A32984B1H.%')
, ('https://tigerforce.io/','Tiger Force','SP2P6KSAJ4JVV8PFSNKJ9BNG5PEPR4RT71VXZHWBK.%')
, ('https://derupt.io/','Derupt','SP3T3JC6V4S94PPB7WFEK17863HPG3EYP6CJ65E7M.%')
, ('https://stacksparrots.com/','Stacks Parrots','SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.%stacks-parrots%')
, ('https://www.projectindigonft.com/','Project Indigo','SP176ZMV706NZGDDX8VSQRGMB7QN33BBDVZ6BMNHD.%')
, ('https://www.stacks-tiles.com/','Stacks Tiles','SPASZ0VJQTS22YR4HCCAGR05GGRF9V8TCM219YQ8.%')
, ('https://www.stackspunks.com/','Stacks Punks','SPJW1XE278YMCEYMXB8ZFGJMH8ZVAAEDP2S2PJYG.stacks-punks-market')
, ('https://thisisnumberone.com/','This is #1','SP3QSAJQ4EA8WXEDSRRKMZZ29NH91VZ6C5X88FGZQ.thisisnumberone%')
, ('https://www.heylayer.com/','HeyLayer','SP248HH800501WYSG7Z2SS1ZWHQW1GGH85ME34NT2.%')
, ('https://www.crashpunks.com/','Crashpunks','SP3QSAJQ4EA8WXEDSRRKMZZ29NH91VZ6C5X88FGZQ.crashpunks%')
, ('https://www.explorerguild.io/','Explorer Guild','SP2X0TZ59D5SZ8ACQ6YMCHHNR2ZN51Z32E2CJ173.%')
, ('https://stackspops.club/','Stacks Pops','SP277HZA8AGXV42MZKDW5B2NNN61RHQ42MTAHVNB1.stacks-pops%')
, ('https://boom.money/nft/boombox','Boomboxes','SP497E7RX3233ATBS2AB9G4WTHB63X5PBSP5VGAQ.boombox%')
, ('https://boom.money/nft/boombox','Boomboxes','SP1QK1AZ24R132C0D84EEQ8Y2JDHARDR58R72E1ZW.boombox%')
, ('https://boom.money/nft/boombox','Boomboxes','SPMS4E9RQ4GCGG68R6D15PKV01TYNCBPYZG1ZMFE.boombox%')
, ('https://bitcoinmonkeys.io/','Bitcoin Monkeys','SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.bitcoin-monkeys%')
, ('https://bitcoinmonkeys.io/','Bitcoin Monkeys','SP125J1ADVYWGWB9NQRCVGKYAG73R17ZNMV17XEJ7.%')
, ('https://bitcoinmonkeys.io/','Bitcoin Monkeys','SPMWNPDCQMCXANG6BYK2TJKXA09BTSTES0VVBXVR.%')
, ('https://nonnish.com/','Nonnish','SPVVASJ83H223TCEP8Z8SHZDFDBFXSM4EGSWCVR2.%')
, ('https://nonnish.com/','Nonnish','SP1D3Y8A2VVD2W98VFXCG5AXRYX5PJBBEMV1YPKF1.%')
, ('https://www.bitcoinbadgers.art/','Bitcoin Badgers','SP38FN88VZ97GWV0E8THXRM6Z5VMFPHFY4J1JEC5S.btc-badgers')
, ('https://www.bitcoinbadgers.art/','Bitcoin Badgers','SP27F9EJH20K3GT6GHZG0RD08REZKY2TDMD6D9M2Z.%badgers%')
, ('https://www.stacksboard.art/','Stacksboard','SPGAKH27HF1T170QET72C727873H911BKNMPF8YB.%')
, ('https://www.stacksboard.art/','Stacksboard','SP1F6E7S7SEZZ2R2VHCY0BYJ2G81CCSSJ7PC4SSHP.%')
, ('https://guestsnft.com/','The Guests','SP1CSHTKVHMMQJ7PRQRFYW6SB4QAW6SR3XY2F81PA.the-guests')
, ('https://guestsnft.com/','The Guests','SPNWZ5V2TPWGQGVDR6T7B6RQ4XMGZ4PXTEE0VQ0S.guests-hosted-stacks-parrots')
, ('https://guestsnft.com/','The Guests','SP1XPG9QFX5M95G36SGN9R8YJ4KJ0JB7ZXNH892N6.the-lolas')
, ('https://guestsnft.com/','The Guests','SP2QDMH88MEZ8FFAYHW4B0BTXJRTHX8XBD54FE7HJ.degen-naming-service')
, ('https://guestsnft.com/','The Guests','SP3252T1HMQHZTA9S22WZ2HZMKC4CVH965SHSERTH.%')
-- , ('https://90stx.xyz/','90stx','%90stx%')
)

select cat.link as "Link", cat.name as "Name"
, count(distinct contract_call_contract_id) as contracts
, count(distinct sender_address) filter (where block_time > now() - interval '7 days') as users_1w
, count(*) filter (where block_time > now() - interval '7 days') as txs_1w
, 1e-6 * sum(amount) filter (where block_time > now() - interval '7 days') as "Raw Vol, 1W (STX)"
, count(distinct sender_address) as users_all
, count(*) as txs_all
, 1e-6 * sum(amount) as "Raw Vol, All (STX)"
from categories cat
join transactions tx on (contract_call_contract_id like cat.contract_like)
left join stx_events sx using (tx_id)
group by 1,2
order by users_1w desc, users_all desc
