with cex (name,accounts) as (
VALUES ('Kraken',ARRAY['SP111MNWTSXGTD0ESMV59WX4KHQA93RTV9F82EK0K'])
, ('Coinbase',ARRAY['SP1FNEJ21BMJCJYEJM2F73QT6WD2MN9MB2J92FZBN','SP1PJWKS5V3X7JR300J3W291DDNCKD6M6XKJFYPAC'
    ,'SPC3T2E3MXHA15Q1TRQJDH57QX6X1D5D7Y9XTXXJ','SPFPBQ30DZ2G4CX8XZGZXD013N2NPHH7K7SB7GEZ'])
, ('Binance',ARRAY['SP1P72Z3704VMT3DMHPP2CB8TGQWGDBHD3RPR9GZS','SP3WV3VC6GM1WF215SDHP0MESQ3BNXHB1N6TPB70S'])
, ('Kucoin',ARRAY['SPX8T06E8FJQ33CX8YVR9CC6D9DSTF6JE0Y8R7DS','SP1V21EG2APTB57VXEM9BK4TFWK1GN8NYW5DB0Q46'
    ,'SP307BHDXSX759Z2XFAM405REWVFJK05HKG7BWRQB'])
, ('Gate.io',ARRAY['SP33XEHK2SXXH625VG6W6665WBBPX1ENQVKNEYCYY'])
, ('Crypto.com',ARRAY['SP1RWW86QN0KKZYZAZ5K4NJX4BQQCVWVSR7CXW5XA','SP243V4D843MNKX5WB46A0PDWH4H5SAQBBHGJN0CH'])
, ('Okcoin',ARRAY['SP3HXJJMJQ06GNAZ8XWDN1QM48JEDC6PP6W3YZPZJ','SP3KANBW2C4E5BRPWNTWZCCDGF2F87CW9D9KV0FFK'])
, ('OKX',ARRAY['SP3RFAZMSH6YA1KTJD7DN997AG2DG54E3Z9ZJWYN8'])
, ('Upbit',ARRAY['SP3G2DMG5WWCP8XF1QZSEQ1XE73X639ABZC835EZV','SPNBYP1MY456K29804XHT4PY5QKMSXNRBHGADTDY'])
, ('BtcTurk',ARRAY['SPXJJ6XPRV52JREBENWFX7TG1CFPFP0QS81BDH0A'])
, ('CoinEx',ARRAY['SP2VK9TBG8E20A0YW228PC70GBMSBFHE7BNVMKB57'])
, ('Unknown 1',ARRAY['SM468VETKA5DB15HWG2QM7Y04EFQKV44R9D6D0QC'])
)

select name, sum(total)
from stxop.accounts
join cex on (account = ANY(accounts))
group by 1
order by 2 desc
